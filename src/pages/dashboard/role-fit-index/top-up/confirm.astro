---
// src/pages/success.astro
// no `prerender` flag â€” it stays static
---

<html>
  <body>
    <h1>Thanks for your payment!</h1>
    <div id="result"></div>

    <script type="module">
      // run in the browser after load
      const params = new URLSearchParams(window.location.search);
      const sessionId = params.get("session_id");

      if (sessionId) {
        document.getElementById("result").textContent =
          "Session ID: " + sessionId;

        // Optionally, call your own API to fetch details
        fetch(
          `/api/stripe/session.json?session_id=${encodeURIComponent(sessionId)}`,
        )
          .then((res) => res.json())
          .then((data) => {
            // update DOM with payment info
            console.log("Session:", data);
          });
      } else {
        document.getElementById("result").textContent = "No session ID found.";
      }
    </script>
  </body>
</html>
